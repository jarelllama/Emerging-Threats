# emerging-threats-dnsbl

Extracts and categorizes domains from Emerging Threats Open rules for people using PiHole and other filtering resolvers, to provide coverage of certain new threats from a reliable source. Updates automatically every day.

### Lists

* **RECOMMENDED: [malicious.txt](https://hosts.tweedge.net/malicious.txt)** - Blocks malware, phishing, coin miners, PUPs, exploits, etc. Suitable for home or corporate environments.
* [suspicious.txt](https://hosts.tweedge.net/suspicious.txt) - Blocks some dynamic DNS, link shorteners, pastebin services, games, etc. Suitable for strict corporate environments.
* [informational.txt](https://hosts.tweedge.net/informational.txt) - Blocks benign callbacks and some potentially unwanted sites (ex. file sharing), etc. May be useful in *some* strict corporate environments.

### FAQ

**Where is this data coming from / what is Emerging Threats?** [Emerging Threats](https://doc.emergingthreats.net/bin/view/Main/EmergingFAQ) is a part of Proofpoint, Inc. They provide the Emerging Threats ruleset, which is a free (BSD-licensed) list of rules that can detect and prevent certain malicious network activity using an IDS/IPS (Intrusion Detection System/Intrusion Prevention System) such as [Snort](https://www.snort.org/) or [Suricata](https://suricata.io/).

**Whoah. Is this how corporations protect themselves?** It's often part of how corporations protect themselves, yep!

**Will this protect me from *all* malware/phishing/etc?** No. However when testing in 2022, I did find that of over 2,000 malicious domains blocked by Emerging Threats, only ~80 existed in common anti-malware lists used in PiHole. To increase the malware-fighting capabilities of your PiHole, I would *strongly* recommend using a public filtering DNS resolver which will have many more sources of threat intelligence integrated, such as [Quad9](https://www.quad9.net/).

**How effective is this compared to running an IDS with Emerging Threats rulesets?** Not good. Emerging Threats ruleset contains much more than DNS rules, and an IDS has *much* more ability to detect circumvention than a filtering DNS resolver does (ex. what happens on your network if malware decided to query a public DNS resolver directly? With an IDS, that would be stopped; with a filtering DNS resolver like PiHole, it would never see the request). You can consider these lists as providing "under 10% of the protection" (~4k domains out of >40k rules, as of 2022) but even that is too generous.

**If this isn't nearly as effective as an IPS, why bother?** I hope that this can help keep some malware/unwanted traffic/etc. off peoples' networks, but I also hope that this can help introduce people who are interested in tech (like PiHole) to some cool security topics like "what is an IDS" and "what is Emerging Threats" and "how do you defend big networks." It might even encourage the [r/homelab](https://www.reddit.com/r/homelab) sort to try deploying an IPS in their environment!

### Todos

This project is in a beta/heavy development state, and there may be signals in Emerging Threats that are not present in the current blocklists generated by this script. Key examples will be added and subtracted below:

```
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET POLICY Observed URL Shortening Service SSL/TLS Cert (rb.gy)"; flow:from_server,established; tls.cert_subject; content:"CN=rb.gy"; fast_pattern; classtype:policy-violation; sid:2036628; rev:1; metadata:created_at 2022_05_19, former_category POLICY, updated_at 2022_05_19;)
```

```
alert dns $HOME_NET any -> any any (msg:"ET POLICY My2022/Beijing2022 App (DNS Lookup) 1"; dns_query; content:"bigdata.beijing2022.cn"; isdataat:!1,relative; reference:url,citizenlab.ca/2022/01/cross-country-exposure-analysis-my2022-olympics-app/; classtype:trojan-activity; sid:2034994; rev:2; metadata:created_at 2022_01_28, former_category POLICY, updated_at 2022_01_28;)
```